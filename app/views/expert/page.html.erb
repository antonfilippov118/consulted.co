<div id="profile">
  <% if user_expert_page? %>
    <div class="alert notice">This is your expert page - to edit your information and availability, <%= link_to 'click here', offers_path %></div>
  <% end %>
  <div id="profile-main" class="row divider">
    <div class="profile-info col-md-7">
      <div class="profile-image">
        <%= image_tag profile_image_url, alt: name, class: 'profile-img' %>
        <% if linkedin_profile? %>
          <%= link_to '', linkedin_profile_url, class: "flaticon flaticon-linkedin", target: '_blank' %>
        <% end %>
      </div>
      <h1>
        <%= name %>
        <%= render partial: 'users/favorites/bookmark' %>
      </h1>
      <% if current_position  && current_company %>
        <p class="bigger"><%= current_position %> at
        <% if company_url %>
          <%= link_to current_company_name, company_url, target: '_blank' %>
        <% else %>
          <%= current_company_name %>
        <% end %>
        </p>
      <% end %>
      <% if summary? %>
        <div class="profile-heading">Profile summary</div>
        <p class="bigger"><%= simple_format summary %></p>
      <% end %>
    </div>
    <% if past_companies? or education? %>
      <div class="profile-side col-md-offset-1 col-md-4">
        <% if past_companies? %>
          <div class="profile-heading">Previous positions</div>
          <ul class="profile-posed">
            <% past_companies.each do |company| %>
              <li>
                <span>
                  <strong><%= company.name %></strong>, <%= company.position %>, <%= career_span(company) %></li>
                </span>
            <% end %>
          </ul>
        <% end %>
        <% if education? %>
          <div class="profile-heading">Education</div>
          <ul class="profile-posed">
            <% educations.each do |edu| %>
              <li>
                <span>
                  <strong><%= edu.name %></strong>, <%= edu.degree %> <%= education_span(edu).nil? ? '' : education_span(edu) %>
                </span>
              </li>
            <% end %>
          </ul>
        <% end %>
      </div>
    <% else %>
      <div class="block"></div>
    <% end %>
  </div>
  <div ng-app="consulted.offer_select" data-expert="<%= @expert.slug %>">
    <div ng-controller="OffersCtrl">
      <h2 class="heading">Expert's service offerings</h2>
      <div ng-show="loading">Loading...</div>
      <div ng-show="!loading && offers.length > 0" class="clr profile-offering" ng-repeat="offer in offers">
        <div class="clr">
          <h3 class="left">{{offer.name}}</h3>
          <% if user_signed_in? %>
            <% unless user_expert_page? %>
              <a ng-click="select(offer)" class="btn btn-select" ng-class="{'active':selected(offer)}">
                <span ng-show="selected(offer)">Selected</span>
                <span ng-hide="selected(offer)">Select</span>
              </a>
            <% end %>
          <% else %>
            <%= link_to 'Signup', new_registrations_path, class: 'btn btn-select' %>
          <% end %>
        </div>
        <div class="row">
          <div class="col-md-5">
            <div class="profile-heading">Expert's note
              <small class="right">Category Experience: {{offer.experience}} years</small>
            </div>
            <p>"{{offer.description}}"</p>
          </div>
          <div class="col-md-5">
            <div class="profile-heading">Description</div>
            <div ng-bind-html="offer.group.description"></div>
          </div>
          <div class="col-md-2">
            <div class="expert-pph text-center">
              <span class="price">${{offer.rate}}</span>/hour</div>
            <div class="expert-rating" ng-show="offer.likes.length > 0">
              <div class="rating-hand">5</div>
              at avg. $65
              <span class="flaticon flaticon-help help" data-toggle="tooltip" data-placement="top" title="" data-original-title="Tooltip on top"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <h2 class="heading">Book a call with <%= name %></h2>
    <div class="book">
      <div class="clr book-langs">
        <div class="book-lang<%= ' active' if @expert.languages.include?('arabic') %>">Arabic</div>
        <div class="book-lang<%= ' active' if @expert.languages.include?('english') %>">English</div>
        <div class="book-lang<%= ' active' if @expert.languages.include?('german') %>">German</div>
        <div class="book-lang<%= ' active' if @expert.languages.include?('mandarin') %>">Mandarin</div>
        <div class="book-lang<%= ' active' if @expert.languages.include?('spanish') %>">Spanish</div>
      </div>
      <div id="scheduler-read" class="scheduler">
        <div ng-controller="AvailabilityCtrl">
          <div data-dhx-scheduler-readonly events='events' style="height: 550px">
            <div class="dhx_cal_prev_button">&nbsp;</div>
            <div class="dhx_cal_next_button">&nbsp;</div>
            <div class="dhx_cal_today_button"></div>
            <div class="dhx_cal_date"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
